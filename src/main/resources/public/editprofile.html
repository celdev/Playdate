<html>

<head>
    <title>Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">

    <script src="https://code.jquery.com/jquery-2.1.4.js" integrity="sha256-siFczlgw4jULnUICcdm9gjQPZkw/YPDqhQ9+nAOScE4=" crossorigin="anonymous"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/jquery.mobile.flatui.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/croppie.css">
    <script src="js/croppie.js"></script>
    <script>
        $(function() {
            $("#side-panel").panel();
            $("[data-role=header], [data-role=footer]").toolbar().enhanceWithin();
            $('#popup').popup();
        });

    </script>
    <script>
        $(document).ready(function() {
            $('#edit-profile-picture').click(function() {
                $('#popup').popup("open");
            })
            $('#picturefile').change(function(e) {
                var files = e.target.files;

                var file = files[0];

                if (file.type.match('image.*')) {
                    var reader = new FileReader();
                    reader.onload = (function(image) {
                        return function(e) {
                            var i = e.target.result;

                            console.log(i)
                            console.log('init croppie')
                            $('#croppie').croppie({
                                viewport: {
                                    width: 260,
                                    height: 260
                                },
                                boundary: {
                                    width: 300,
                                    height: 300
                                },
                                url: i
                            });
                            console.log('loaded url')
                            $('#upload-div').hide()

                        };
                    })(file);

                    reader.readAsDataURL(file);

                }
            })


            $('#upload-picture').click(function() {
                var picture = $('#croppie').croppie('result', 'blob', 'viewport', 'png');
                //todo kontrollera att bilden inte är för stor
                //todo skicka bilden till backend
            })


        });

    </script>
</head>

<body>

    <div data-role="panel" data-theme="a" id="side-panel" data-display="overlay" data-position-fixed="true">
        <div class="close-btn-pos header-shadow">
            <h2>Meny</h2>
            <a href="#" class="ui-btn ui-icon-delete ui-btn-icon-notext
			ui-corner-all" data-rel="close"></a>
        </div>
        <div id="inner-panel">
            <div class="small-profile">
                <span>Name Namesson</span>
                <div class="composite-row">
                    <img src="images/profilbild.png">
                    <span>Pappa till Bengt-Göran, 2år och Gösta-Lisa, 4år. Gillar brev och bildäck. En perfekt playdate....
                </span>
                </div>
            </div>

            <div class="panel-buttons">
                <a href="/protected/showprofile" class="ui-btn ui-corner-all">Min Profil</a>
                <a href="#show-playdates" class="ui-btn ui-corner-all">Mina Playdates</a>
                <a href="#" class="ui-btn ui-corner-all">Mina Vänner</a>
                <a href="#" class="ui-btn ui-corner-all">Hitta Platser</a>
                <a href="#NamnpåpageID" class="ui-btn ui-corner-all ui-icon-logout">Logga Ut</a>

            </div>
        </div>

    </div>

    <div data-role="header" data-position="fixed" class="header-shadow" data-theme="a" data-tap-toggle="false" data-hide-during-focus="">
        <a href="#side-panel" class="ui-btn ui-icon-bars ui-btn-icon-notext ui-corner-all">Öppna panelen</a>
        <h1>Playdate</h1>
    </div>

    <div data-role="footer" data-position="fixed" data-theme="a" id="footer" data-tap-toggle="false" data-hide-during-focus="">
        <div class="ui-grid-d center">
            <div class="ui-block-a center-content"><a class="ui-shadow ui-btn ui-corner-all ui-icon-back ui-btn-inline ui-btn-icon-top">Tillbaka</a>
            </div>
            <div class="ui-block-b center-content"><a class="ui-shadow ui-btn ui-corner-all ui-icon-heart ui-btn-icon-top ui-btn-inline">Vänner</a>
            </div>
            <div class="ui-block-c center-content"><a class="ui-shadow ui-btn ui-corner-all ui-icon-home ui-btn-icon-top ui-btn-inline">Feed</a>
            </div>
            <div class="ui-block-d center-content"><a class="ui-shadow ui-btn ui-corner-all ui-icon-calendar ui-btn-icon-top ui-btn-inline">Event</a>
            </div>
            <div class="ui-block-e center-content"><a class="ui-shadow ui-btn ui-corner-all ui-icon-mail ui-btn-icon-top ui-btn-inline">Mail</a>
            </div>
        </div>
    </div>
    <div data-role="page" id="pageone">




        <div data-role="main" class="ui-content">
            <h2>Name Namesson</h2>
            <div class="ui-grid-a profile-page">
                <div class="ui-block-a">
                    <div id="composite-picture">
                        <a href="#" data-rel="popup" class="ui-btn ui-corner-all ui-icon-edit ui-btn-icon-notext ui-overlay-shadow" id="edit-profile-picture" data-ajax="false">Edit Icon</a>
                        <img src="images/profilbild.png" class="profile-picture" style="width: 9em">
                    </div>
                </div>
                <div class="ui-block-b">

                    <label for="phoneinput">Telefonnummer:</label>
                    <input type="text" name="phoneinput" id="phoneinput" value="08-702 00 90">

                    <label for="genderselect" class="select" style="display: inline; margin-right: 1em">Kön:</label>
                    <select name="genderselect" id="genderselect" data-inline="true">
                <option value="0">Man</option>
                <option value="1">Kvinna</option>
                <option value="2">Annat</option>
            </select>
                </div>
                <textarea cols="40" name="description" rows="20" id="descriptiontextarea" data-autogrow="false"> Description des description description description
            </textarea>
            </div>
            <div class="on-bottom-button">
                <a class="ui-btn">Uppdatera Profil</a>
            </div>
        </div>
        <div data-role="popup" id="popup" data-dismissible="false">
            <a href="#" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
            <div data-role="header">
                <h1>Ny Profilbild</h1>
            </div>
            <div data-role="main" class="ui-content">
                <div id="dialog-changable-content">
                    <div id="croppie"></div>
                    <div id="upload-div">
                        <p>Välj ny profilbild. Max 360x360 pixlar</p>
                        <form>
                            <input type="file" name="picture" id="picturefile">
                        </form>
                    </div>
                </div>
            </div>
            <div data-role="footer">
                <a href="#" class="ui-btn" id="upload-picture">Ladda upp bild</a>
            </div>
        </div>
    </div>


</body>

</html>
